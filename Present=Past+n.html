<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Irregular Verbs Master</title>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
        body {
            box-sizing: border-box;
        }
        
        .sparkle-animation {
            animation: sparkle 3s ease-out infinite;
        }
        
        @keyframes sparkle {
            0% { 
                transform: scale(1) rotate(0deg); 
                opacity: 1; 
                filter: hue-rotate(0deg) brightness(1) saturate(1) drop-shadow(0 0 5px gold);
            }
            25% { 
                transform: scale(1.5) rotate(90deg); 
                opacity: 0.9; 
                filter: hue-rotate(90deg) brightness(2) saturate(3) drop-shadow(0 0 15px cyan);
            }
            50% { 
                transform: scale(2) rotate(180deg); 
                opacity: 0.8; 
                filter: hue-rotate(180deg) brightness(3) saturate(4) drop-shadow(0 0 25px magenta);
            }
            75% { 
                transform: scale(1.5) rotate(270deg); 
                opacity: 0.9; 
                filter: hue-rotate(270deg) brightness(2) saturate(3) drop-shadow(0 0 15px lime);
            }
            100% { 
                transform: scale(1) rotate(360deg); 
                opacity: 1; 
                filter: hue-rotate(360deg) brightness(1) saturate(1) drop-shadow(0 0 5px gold);
            }
        }
        
        .floating-particles {
            position: absolute;
            pointer-events: none;
            z-index: 1000;
        }
        
        .particle {
            position: absolute;
            animation: float 3s ease-out forwards;
        }
        
        @keyframes float {
            0% {
                transform: translateY(0) scale(1) rotate(0deg);
                opacity: 1;
                filter: hue-rotate(0deg) brightness(2);
            }
            50% {
                transform: translateY(-50px) scale(1.5) rotate(180deg);
                opacity: 0.8;
                filter: hue-rotate(180deg) brightness(3);
            }
            100% {
                transform: translateY(-150px) scale(0.2) rotate(360deg);
                opacity: 0;
                filter: hue-rotate(360deg) brightness(1);
            }
        }
        
        .rainbow-border {
            animation: rainbowBorder 1.5s linear infinite;
        }
        
        @keyframes rainbowBorder {
            0% { border-color: #ff0000; box-shadow: 0 0 30px #ff0000, inset 0 0 20px rgba(255,0,0,0.3); }
            16% { border-color: #ff8000; box-shadow: 0 0 30px #ff8000, inset 0 0 20px rgba(255,128,0,0.3); }
            33% { border-color: #ffff00; box-shadow: 0 0 30px #ffff00, inset 0 0 20px rgba(255,255,0,0.3); }
            50% { border-color: #00ff00; box-shadow: 0 0 30px #00ff00, inset 0 0 20px rgba(0,255,0,0.3); }
            66% { border-color: #0080ff; box-shadow: 0 0 30px #0080ff, inset 0 0 20px rgba(0,128,255,0.3); }
            83% { border-color: #8000ff; box-shadow: 0 0 30px #8000ff, inset 0 0 20px rgba(128,0,255,0.3); }
            100% { border-color: #ff0000; box-shadow: 0 0 30px #ff0000, inset 0 0 20px rgba(255,0,0,0.3); }
        }
        
        .correct-match {
            animation: correctPulse 1.2s ease-out;
        }
        
        @keyframes correctPulse {
            0% { 
                transform: scale(1); 
                background: linear-gradient(45deg, #dcfce7, #bbf7d0);
                box-shadow: 0 0 0 rgba(34, 197, 94, 0);
            }
            25% { 
                transform: scale(1.05); 
                background: linear-gradient(45deg, #bbf7d0, #86efac);
                box-shadow: 0 0 20px rgba(34, 197, 94, 0.4);
            }
            50% { 
                transform: scale(1.1); 
                background: linear-gradient(45deg, #86efac, #4ade80);
                box-shadow: 0 0 30px rgba(34, 197, 94, 0.6);
            }
            75% { 
                transform: scale(1.05); 
                background: linear-gradient(45deg, #4ade80, #22c55e);
                box-shadow: 0 0 20px rgba(34, 197, 94, 0.4);
            }
            100% { 
                transform: scale(1); 
                background: linear-gradient(45deg, #dcfce7, #bbf7d0);
                box-shadow: 0 0 0 rgba(34, 197, 94, 0);
            }
        }
        
        .incorrect-shake {
            animation: incorrectShake 1s ease-out;
        }
        
        @keyframes incorrectShake {
            0%, 100% { 
                transform: translateX(0); 
                background: linear-gradient(45deg, #fef2f2, #fecaca);
                box-shadow: 0 0 0 rgba(239, 68, 68, 0);
            }
            15% { 
                transform: translateX(-15px) rotate(-2deg); 
                background: linear-gradient(45deg, #fecaca, #fca5a5);
                box-shadow: 0 0 15px rgba(239, 68, 68, 0.3);
            }
            30% { 
                transform: translateX(15px) rotate(2deg); 
                background: linear-gradient(45deg, #fca5a5, #f87171);
                box-shadow: 0 0 20px rgba(239, 68, 68, 0.4);
            }
            45% { 
                transform: translateX(-10px) rotate(-1deg); 
                background: linear-gradient(45deg, #f87171, #ef4444);
                box-shadow: 0 0 25px rgba(239, 68, 68, 0.5);
            }
            60% { 
                transform: translateX(10px) rotate(1deg); 
                background: linear-gradient(45deg, #ef4444, #dc2626);
                box-shadow: 0 0 20px rgba(239, 68, 68, 0.4);
            }
            75% { 
                transform: translateX(-5px); 
                background: linear-gradient(45deg, #dc2626, #f87171);
                box-shadow: 0 0 15px rgba(239, 68, 68, 0.3);
            }
        }
        
        .dragging {
            opacity: 0.7;
            transform: rotate(5deg) scale(1.05);
            z-index: 1000;
        }
        
        .drop-zone {
            transition: all 0.3s ease;
        }
        
        .drop-zone.drag-over {
            background-color: #f0f9ff;
            border-color: #3b82f6;
            transform: scale(1.02);
        }
        
        .countdown-pulse {
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        .section-transition {
            animation: slideIn 0.5s ease-out;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .perfect-celebration {
            animation: celebrate 4s ease-out infinite;
        }
        
        @keyframes celebrate {
            0% { 
                transform: scale(1) rotate(0deg); 
                background: linear-gradient(45deg, #fef3c7, #fde68a, #f59e0b);
                box-shadow: 0 0 0 rgba(245, 158, 11, 0), 0 0 50px rgba(255, 215, 0, 0.8);
            }
            15% { 
                transform: scale(1.2) rotate(-15deg); 
                background: linear-gradient(45deg, #fde68a, #fcd34d, #d97706);
                box-shadow: 0 0 40px rgba(245, 158, 11, 0.6), 0 0 80px rgba(255, 215, 0, 1);
            }
            30% { 
                transform: scale(1.4) rotate(15deg); 
                background: linear-gradient(45deg, #fcd34d, #f59e0b, #ea580c);
                box-shadow: 0 0 60px rgba(245, 158, 11, 0.8), 0 0 120px rgba(255, 215, 0, 1);
            }
            45% { 
                transform: scale(1.3) rotate(-10deg); 
                background: linear-gradient(45deg, #f59e0b, #d97706, #c2410c);
                box-shadow: 0 0 50px rgba(245, 158, 11, 0.7), 0 0 100px rgba(255, 215, 0, 0.9);
            }
            60% { 
                transform: scale(1.5) rotate(12deg); 
                background: linear-gradient(45deg, #d97706, #f59e0b, #fcd34d);
                box-shadow: 0 0 70px rgba(245, 158, 11, 0.9), 0 0 140px rgba(255, 215, 0, 1);
            }
            75% { 
                transform: scale(1.2) rotate(-8deg); 
                background: linear-gradient(45deg, #f59e0b, #fcd34d, #fde68a);
                box-shadow: 0 0 45px rgba(245, 158, 11, 0.6), 0 0 90px rgba(255, 215, 0, 0.8);
            }
            90% { 
                transform: scale(1.1) rotate(5deg); 
                background: linear-gradient(45deg, #fcd34d, #fde68a, #fef3c7);
                box-shadow: 0 0 30px rgba(245, 158, 11, 0.4), 0 0 60px rgba(255, 215, 0, 0.6);
            }
            100% { 
                transform: scale(1) rotate(0deg); 
                background: linear-gradient(45deg, #fef3c7, #fde68a, #f59e0b);
                box-shadow: 0 0 0 rgba(245, 158, 11, 0), 0 0 50px rgba(255, 215, 0, 0.8);
            }
        }
        
        .level-complete-burst {
            animation: levelBurst 2s ease-out;
        }
        
        @keyframes levelBurst {
            0% {
                transform: scale(0.8);
                background: radial-gradient(circle, #fbbf24, #f59e0b, #d97706);
                box-shadow: 0 0 0 rgba(251, 191, 36, 0);
            }
            50% {
                transform: scale(1.3);
                background: radial-gradient(circle, #fde047, #facc15, #eab308);
                box-shadow: 0 0 100px rgba(251, 191, 36, 0.8);
            }
            100% {
                transform: scale(1);
                background: radial-gradient(circle, #fef3c7, #fde68a, #fcd34d);
                box-shadow: 0 0 50px rgba(251, 191, 36, 0.4);
            }
        }
        
        .score-pop {
            animation: scorePop 0.8s ease-out;
        }
        
        @keyframes scorePop {
            0% {
                transform: scale(1);
                color: inherit;
            }
            50% {
                transform: scale(1.5);
                color: #10b981;
                text-shadow: 0 0 20px #10b981;
            }
            100% {
                transform: scale(1);
                color: inherit;
            }
        }
        
        .button-glow {
            animation: buttonGlow 2s ease-in-out infinite;
        }
        
        @keyframes buttonGlow {
            0%, 100% {
                box-shadow: 0 0 5px rgba(59, 130, 246, 0.5);
            }
            50% {
                box-shadow: 0 0 25px rgba(59, 130, 246, 0.8), 0 0 35px rgba(59, 130, 246, 0.6);
            }
        }
        
        .fireworks {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9999;
        }
        
        .firework {
            position: absolute;
            animation: firework 2s ease-out forwards;
        }
        
        @keyframes firework {
            0% {
                transform: scale(0) rotate(0deg);
                opacity: 1;
            }
            50% {
                transform: scale(1.5) rotate(180deg);
                opacity: 0.8;
            }
            100% {
                transform: scale(3) rotate(360deg);
                opacity: 0;
            }
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="min-h-full bg-gradient-to-br from-purple-100 to-pink-100"><!-- Header -->
  <header class="bg-white shadow-lg p-6">
   <div class="max-w-6xl mx-auto text-center">
    <h1 id="game-title" class="text-4xl font-bold text-purple-800 mb-2 sparkle-animation">Irregular Verbs Master</h1>
    <div class="flex justify-center space-x-8 mt-4"><button id="section1-btn" class="px-6 py-3 bg-blue-500 text-white rounded-lg font-semibold hover:bg-blue-600 transition-colors button-glow"> üéØ Practice </button> <button id="section2-btn" class="px-6 py-3 bg-green-500 text-white rounded-lg font-semibold hover:bg-green-600 transition-colors button-glow"> üìù Fill Gaps </button> <button id="section3-btn" class="px-6 py-3 bg-orange-500 text-white rounded-lg font-semibold hover:bg-orange-600 transition-colors button-glow"> üìö Story Time </button>
    </div>
   </div>
  </header><!-- Section 1: Practice Matching -->
  <section id="section1" class="section-content p-6">
   <div class="max-w-6xl mx-auto">
    <div class="text-center mb-6">
     <h2 id="section-1-title" class="text-3xl font-bold text-blue-800 mb-4">üéØ Verb Matching Practice</h2>
     <div class="bg-white rounded-lg p-4 inline-block shadow-lg rainbow-border">
      <div class="flex items-center space-x-4"><span class="text-lg font-semibold">Level: <span id="level-display">1</span>/3</span>
       <div class="text-2xl font-bold text-red-500 countdown-pulse">
        ‚è∞ <span id="countdown">60</span>s
       </div><span class="text-lg font-semibold">Score: <span id="practice-score">0</span></span>
      </div>
     </div>
    </div>
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8"><!-- Verbs to Match -->
     <div class="bg-white rounded-xl p-6 shadow-lg">
      <h3 class="text-xl font-bold text-center mb-4 text-blue-700">Drag the Verbs</h3>
      <div id="verbs-container" class="space-y-3"><!-- Populated by JavaScript -->
      </div>
     </div><!-- Drop Zones -->
     <div class="bg-white rounded-xl p-6 shadow-lg">
      <h3 class="text-xl font-bold text-center mb-4 text-blue-700">Match with Forms</h3>
      <div id="forms-container" class="space-y-3"><!-- Populated by JavaScript -->
      </div>
     </div>
    </div>
   </div>
  </section><!-- Section 2: Fill in the Gaps -->
  <section id="section2" class="section-content p-6 hidden">
   <div class="max-w-4xl mx-auto">
    <div class="text-center mb-6">
     <h2 id="section-2-title" class="text-3xl font-bold text-green-800 mb-4">üìù Fill in the Gaps</h2>
     <div class="bg-white rounded-lg p-4 inline-block shadow-lg"><span class="text-lg font-semibold">Progress: <span id="gaps-progress">0</span>/8</span>
     </div>
    </div>
    <div class="bg-white rounded-xl p-8 shadow-lg">
     <div id="sentences-container" class="space-y-6"><!-- Populated by JavaScript -->
     </div>
    </div>
   </div>
  </section><!-- Section 3: Story Writing -->
  <section id="section3" class="section-content p-6 hidden">
   <div class="max-w-4xl mx-auto">
    <div class="text-center mb-6">
     <h2 id="section-3-title" class="text-3xl font-bold text-orange-800 mb-4">üìö Complete the Story</h2>
     <div class="bg-white rounded-lg p-4 inline-block shadow-lg"><span class="text-lg font-semibold">Story Progress: <span id="story-progress">0</span>/6</span>
     </div>
    </div>
    <div class="bg-white rounded-xl p-8 shadow-lg">
     <div id="story-container" class="text-lg leading-relaxed"><!-- Populated by JavaScript -->
     </div>
    </div>
   </div>
  </section><!-- Feedback Modal -->
  <div id="feedback-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
   <div class="bg-white rounded-xl p-8 max-w-md mx-4 text-center">
    <div id="feedback-icon" class="text-6xl mb-4"></div>
    <h3 id="feedback-title" class="text-2xl font-bold mb-2"></h3>
    <p id="feedback-message" class="text-gray-600 mb-6"></p><button id="feedback-close" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-lg font-semibold transition-colors"> Continue </button>
   </div>
  </div><!-- Perfect Score Celebration -->
  <div id="perfect-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
   <div class="bg-gradient-to-br from-yellow-200 to-orange-200 rounded-xl p-8 max-w-md mx-4 text-center perfect-celebration rainbow-border">
    <div class="text-8xl mb-4 sparkle-animation">
     ‚ú®üèÜ‚ú®
    </div>
    <h3 class="text-4xl font-bold text-orange-800 mb-2 sparkle-animation">PERFECT!</h3>
    <p class="text-xl text-orange-700 mb-6">üéâ Amazing work! You're a verb master! üéâ</p>
    <div class="text-6xl mb-4 sparkle-animation">
     üåü‚≠êüåü‚≠êüåü
    </div><button id="perfect-close" class="bg-gradient-to-r from-orange-500 to-yellow-500 hover:from-orange-600 hover:to-yellow-600 text-white px-8 py-4 rounded-lg font-bold text-lg transition-all transform hover:scale-105 rainbow-border"> ‚ú® Continue Your Journey! ‚ú® </button>
   </div>
  </div><!-- Fireworks Container -->
  <div id="fireworks-container" class="fireworks hidden"></div>
  <script>
        // Game data
        const irregularVerbs = [
            { base: 'know', past: 'knew', pastParticiple: 'known', emoji: 'üß†' },
            { base: 'blow', past: 'blew', pastParticiple: 'blown', emoji: 'üí®' },
            { base: 'grow', past: 'grew', pastParticiple: 'grown', emoji: 'üå±' },
            { base: 'throw', past: 'threw', pastParticiple: 'thrown', emoji: '‚öæ' },
            { base: 'draw', past: 'drew', pastParticiple: 'drawn', emoji: '‚úèÔ∏è' },
            { base: 'withdraw', past: 'withdrew', pastParticiple: 'withdrawn', emoji: 'üèß' },
            { base: 'show', past: 'showed', pastParticiple: 'shown', emoji: 'üëÅÔ∏è' },
            { base: 'see', past: 'saw', pastParticiple: 'seen', emoji: 'üëÄ' },
            { base: 'wear', past: 'wore', pastParticiple: 'worn', emoji: 'üëï' },
            { base: 'tear', past: 'tore', pastParticiple: 'torn', emoji: 'üíß' },
            { base: 'swear', past: 'swore', pastParticiple: 'sworn', emoji: 'ü§ö' }
        ];

        // Default configuration
        const defaultConfig = {
            game_title: "Irregular Verbs Master",
            section_1_title: "üéØ Verb Matching Practice",
            section_2_title: "üìù Fill in the Gaps",
            section_3_title: "üìö Complete the Story"
        };

        // Game state
        let currentSection = 1;
        let currentLevel = 1;
        let practiceScore = 0;
        let gapsProgress = 0;
        let storyProgress = 0;
        let countdownTimer;
        let timeLeft = 60;

        // Section 1: Practice data
        let currentVerbs = [];
        let matchedPairs = 0;

        // Section 2: Fill gaps data
        const gapSentences = [
            { text: "I have _____ this movie before.", verb: "see", form: "seen", tense: "present perfect" },
            { text: "She _____ a beautiful dress to the party.", verb: "wear", form: "wore", tense: "past simple" },
            { text: "The wind _____ the leaves away.", verb: "blow", form: "blew", tense: "past simple" },
            { text: "He has _____ very tall this year.", verb: "grow", form: "grown", tense: "present perfect" },
            { text: "They _____ the ball across the field.", verb: "throw", form: "threw", tense: "past simple" },
            { text: "The artist has _____ a masterpiece.", verb: "draw", form: "drawn", tense: "present perfect" },
            { text: "I _____ the answer to that question.", verb: "know", form: "knew", tense: "past simple" },
            { text: "The paper was _____ into pieces.", verb: "tear", form: "torn", tense: "past participle" }
        ];

        // Section 3: Story data
        const storyTemplate = `
            Last summer, I _____ (see) something amazing at the park. A young artist _____ (draw) portraits of people. 
            She had _____ (grow) up in the neighborhood and everyone _____ (know) her talent. 
            The wind _____ (blow) her papers around, but she never gave up. 
            I have _____ (wear) the portrait she made of me ever since on my wall at home.
        `;

        const storyAnswers = [
            { blank: 1, verb: "see", correct: "saw", options: ["see", "saw", "seen"] },
            { blank: 2, verb: "draw", correct: "drew", options: ["draw", "drew", "drawn"] },
            { blank: 3, verb: "grow", correct: "grown", options: ["grow", "grew", "grown"] },
            { blank: 4, verb: "know", correct: "knew", options: ["know", "knew", "known"] },
            { blank: 5, verb: "blow", correct: "blew", options: ["blow", "blew", "blown"] },
            { blank: 6, verb: "wear", correct: "worn", options: ["wear", "wore", "worn"] }
        ];

        // Particle effects system
        function createParticles(element, count = 8) {
            const rect = element.getBoundingClientRect();
            const particles = document.createElement('div');
            particles.className = 'floating-particles';
            particles.style.left = rect.left + 'px';
            particles.style.top = rect.top + 'px';
            particles.style.width = rect.width + 'px';
            particles.style.height = rect.height + 'px';
            
            const emojis = ['‚ú®', 'üåü', '‚≠ê', 'üí´', 'üéâ', 'üéä', 'üî•', 'üíé'];
            
            for (let i = 0; i < count; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.textContent = emojis[Math.floor(Math.random() * emojis.length)];
                particle.style.left = Math.random() * rect.width + 'px';
                particle.style.top = Math.random() * rect.height + 'px';
                particle.style.fontSize = (Math.random() * 20 + 15) + 'px';
                particle.style.animationDelay = Math.random() * 0.5 + 's';
                particles.appendChild(particle);
            }
            
            document.body.appendChild(particles);
            
            setTimeout(() => {
                particles.remove();
            }, 3000);
        }

        // Fireworks system
        function createFireworks() {
            const container = document.getElementById('fireworks-container');
            container.classList.remove('hidden');
            
            const fireworkEmojis = ['üéÜ', 'üéá', '‚ú®', 'üåü', 'üí•'];
            
            for (let i = 0; i < 15; i++) {
                setTimeout(() => {
                    const firework = document.createElement('div');
                    firework.className = 'firework';
                    firework.textContent = fireworkEmojis[Math.floor(Math.random() * fireworkEmojis.length)];
                    firework.style.left = Math.random() * window.innerWidth + 'px';
                    firework.style.top = Math.random() * window.innerHeight + 'px';
                    firework.style.fontSize = (Math.random() * 30 + 20) + 'px';
                    firework.style.color = `hsl(${Math.random() * 360}, 100%, 50%)`;
                    
                    container.appendChild(firework);
                    
                    setTimeout(() => {
                        firework.remove();
                    }, 2000);
                }, i * 200);
            }
            
            setTimeout(() => {
                container.classList.add('hidden');
            }, 4000);
        }

        // Initialize game
        function initializeGame() {
            setupSectionNavigation();
            initializeSection1();
        }

        // Section navigation
        function setupSectionNavigation() {
            document.getElementById('section1-btn').addEventListener('click', () => showSection(1));
            document.getElementById('section2-btn').addEventListener('click', () => showSection(2));
            document.getElementById('section3-btn').addEventListener('click', () => showSection(3));
        }

        function showSection(sectionNum) {
            // Hide all sections
            document.querySelectorAll('.section-content').forEach(section => {
                section.classList.add('hidden');
            });
            
            // Show selected section
            document.getElementById(`section${sectionNum}`).classList.remove('hidden');
            document.getElementById(`section${sectionNum}`).classList.add('section-transition');
            
            currentSection = sectionNum;
            
            // Initialize section-specific content
            if (sectionNum === 1) initializeSection1();
            else if (sectionNum === 2) initializeSection2();
            else if (sectionNum === 3) initializeSection3();
        }

        // Section 1: Practice Matching
        function initializeSection1() {
            currentLevel = 1;
            practiceScore = 0;
            startLevel();
        }

        function startLevel() {
            timeLeft = 60;
            matchedPairs = 0;
            
            // Select verbs for current level
            const verbsPerLevel = 4;
            const startIndex = (currentLevel - 1) * verbsPerLevel;
            currentVerbs = irregularVerbs.slice(startIndex, startIndex + verbsPerLevel);
            
            updatePracticeDisplay();
            renderPracticeVerbs();
            startCountdown();
        }

        function updatePracticeDisplay() {
            document.getElementById('level-display').textContent = currentLevel;
            document.getElementById('practice-score').textContent = practiceScore;
            document.getElementById('countdown').textContent = timeLeft;
        }

        function renderPracticeVerbs() {
            const verbsContainer = document.getElementById('verbs-container');
            const formsContainer = document.getElementById('forms-container');
            
            verbsContainer.innerHTML = '';
            formsContainer.innerHTML = '';
            
            // Shuffle verbs and forms
            const shuffledVerbs = [...currentVerbs].sort(() => Math.random() - 0.5);
            const shuffledForms = [...currentVerbs].sort(() => Math.random() - 0.5);
            
            // Render draggable verbs
            shuffledVerbs.forEach(verb => {
                const verbElement = document.createElement('div');
                verbElement.className = 'bg-blue-100 border-2 border-blue-300 rounded-lg p-4 cursor-grab hover:bg-blue-200 transition-colors';
                verbElement.draggable = true;
                verbElement.dataset.verb = verb.base;
                verbElement.innerHTML = `
                    <div class="flex items-center space-x-3">
                        <span class="text-2xl">${verb.emoji}</span>
                        <span class="font-semibold text-blue-800">${verb.base}</span>
                    </div>
                `;
                verbElement.addEventListener('dragstart', handleDragStart);
                verbElement.addEventListener('dragend', handleDragEnd);
                verbsContainer.appendChild(verbElement);
            });
            
            // Render drop zones for forms
            shuffledForms.forEach(verb => {
                const formElement = document.createElement('div');
                formElement.className = 'drop-zone bg-gray-50 border-2 border-dashed border-gray-300 rounded-lg p-4 min-h-16 flex items-center justify-center';
                formElement.dataset.verb = verb.base;
                formElement.innerHTML = `
                    <div class="text-center text-gray-500">
                        <div class="font-semibold">${verb.past} / ${verb.pastParticiple}</div>
                        <div class="text-sm">Drop "${verb.base}" here</div>
                    </div>
                `;
                formElement.addEventListener('dragover', handleDragOver);
                formElement.addEventListener('dragenter', handleDragEnter);
                formElement.addEventListener('dragleave', handleDragLeave);
                formElement.addEventListener('drop', handleDrop);
                formsContainer.appendChild(formElement);
            });
        }

        function startCountdown() {
            clearInterval(countdownTimer);
            countdownTimer = setInterval(() => {
                timeLeft--;
                document.getElementById('countdown').textContent = timeLeft;
                
                if (timeLeft <= 0) {
                    clearInterval(countdownTimer);
                    showFeedback('‚è∞', 'Time\'s Up!', 'Try again to improve your speed!', false);
                }
            }, 1000);
        }

        // Drag and drop handlers
        function handleDragStart(e) {
            e.target.classList.add('dragging');
            createParticles(e.target, 4);
        }

        function handleDragEnd(e) {
            e.target.classList.remove('dragging');
        }

        function handleDragOver(e) {
            e.preventDefault();
        }

        function handleDragEnter(e) {
            e.preventDefault();
            e.currentTarget.classList.add('drag-over');
        }

        function handleDragLeave(e) {
            if (!e.currentTarget.contains(e.relatedTarget)) {
                e.currentTarget.classList.remove('drag-over');
            }
        }

        function handleDrop(e) {
            e.preventDefault();
            const dropZone = e.currentTarget;
            const draggedItem = document.querySelector('.dragging');
            
            if (!draggedItem) return;
            
            dropZone.classList.remove('drag-over');
            
            const draggedVerb = draggedItem.dataset.verb;
            const targetVerb = dropZone.dataset.verb;
            
            if (draggedVerb === targetVerb) {
                // Correct match
                dropZone.classList.add('correct-match');
                draggedItem.style.display = 'none';
                dropZone.innerHTML = `
                    <div class="text-center text-green-700">
                        <div class="text-2xl mb-1">‚úÖ</div>
                        <div class="font-semibold">Correct!</div>
                    </div>
                `;
                
                matchedPairs++;
                practiceScore += 10;
                updatePracticeDisplay();
                
                // Add score animation and particles
                const scoreElement = document.getElementById('practice-score');
                scoreElement.classList.add('score-pop');
                createParticles(dropZone, 6);
                
                setTimeout(() => {
                    scoreElement.classList.remove('score-pop');
                    dropZone.classList.remove('correct-match');
                }, 800);
                
                // Check if level complete
                if (matchedPairs === currentVerbs.length) {
                    clearInterval(countdownTimer);
                    if (currentLevel < 3) {
                        showFeedback('üéâ', 'Level Complete!', `Great job! Moving to level ${currentLevel + 1}`, true);
                        currentLevel++;
                        setTimeout(() => startLevel(), 2000);
                    } else {
                        createFireworks();
                        showPerfectScore();
                    }
                }
            } else {
                // Incorrect match
                draggedItem.classList.add('incorrect-shake');
                showFeedback('‚ùå', 'Not quite right!', `"${draggedVerb}" doesn't match this form. Try again!`, false);
                
                setTimeout(() => {
                    draggedItem.classList.remove('incorrect-shake');
                }, 600);
            }
        }

        // Section 2: Fill in the Gaps
        function initializeSection2() {
            gapsProgress = 0;
            renderGapSentences();
        }

        function renderGapSentences() {
            const container = document.getElementById('sentences-container');
            container.innerHTML = '';
            
            gapSentences.forEach((sentence, index) => {
                const sentenceDiv = document.createElement('div');
                sentenceDiv.className = 'bg-green-50 border border-green-200 rounded-lg p-6';
                
                const verb = irregularVerbs.find(v => v.base === sentence.verb);
                const options = [sentence.form, verb.past, verb.pastParticiple].filter((v, i, arr) => arr.indexOf(v) === i);
                const shuffledOptions = options.sort(() => Math.random() - 0.5);
                
                sentenceDiv.innerHTML = `
                    <div class="mb-4">
                        <span class="text-lg">${sentence.text.replace('_____', '<span class="bg-yellow-200 px-2 py-1 rounded font-semibold">_____</span>')}</span>
                    </div>
                    <div class="flex space-x-3">
                        ${shuffledOptions.map(option => `
                            <button class="gap-option px-4 py-2 bg-white border border-green-300 rounded-lg hover:bg-green-100 transition-colors" 
                                    data-sentence="${index}" data-option="${option}">
                                ${option}
                            </button>
                        `).join('')}
                    </div>
                    <div class="mt-2 text-sm text-gray-600">Tense: ${sentence.tense}</div>
                `;
                
                container.appendChild(sentenceDiv);
            });
            
            // Add event listeners
            document.querySelectorAll('.gap-option').forEach(button => {
                button.addEventListener('click', handleGapAnswer);
            });
        }

        function handleGapAnswer(e) {
            const sentenceIndex = parseInt(e.target.dataset.sentence);
            const selectedOption = e.target.dataset.option;
            const correctAnswer = gapSentences[sentenceIndex].form;
            
            const sentenceDiv = e.target.closest('div').parentElement;
            const buttons = sentenceDiv.querySelectorAll('.gap-option');
            
            if (selectedOption === correctAnswer) {
                e.target.classList.add('bg-green-500', 'text-white');
                buttons.forEach(btn => btn.disabled = true);
                gapsProgress++;
                document.getElementById('gaps-progress').textContent = gapsProgress;
                
                createParticles(e.target, 4);
                
                if (gapsProgress === gapSentences.length) {
                    createFireworks();
                    showPerfectScore();
                }
            } else {
                e.target.classList.add('bg-red-500', 'text-white');
                e.target.disabled = true;
                showFeedback('‚ùå', 'Try Again!', `The correct answer is "${correctAnswer}". Keep trying!`, false);
            }
        }

        // Section 3: Story Writing
        function initializeSection3() {
            storyProgress = 0;
            renderStory();
        }

        function renderStory() {
            const container = document.getElementById('story-container');
            let storyHtml = storyTemplate;
            
            storyAnswers.forEach((answer, index) => {
                const selectHtml = `
                    <select class="story-select bg-yellow-100 border-2 border-yellow-300 rounded px-2 py-1 font-semibold" 
                            data-blank="${answer.blank}" data-correct="${answer.correct}">
                        <option value="">Choose...</option>
                        ${answer.options.map(option => `<option value="${option}">${option}</option>`).join('')}
                    </select>
                `;
                storyHtml = storyHtml.replace('_____', selectHtml);
            });
            
            container.innerHTML = storyHtml;
            
            // Add event listeners
            document.querySelectorAll('.story-select').forEach(select => {
                select.addEventListener('change', handleStoryAnswer);
            });
        }

        function handleStoryAnswer(e) {
            const selectedValue = e.target.value;
            const correctAnswer = e.target.dataset.correct;
            
            if (selectedValue === correctAnswer) {
                e.target.classList.remove('bg-yellow-100', 'border-yellow-300');
                e.target.classList.add('bg-green-100', 'border-green-300');
                e.target.disabled = true;
                storyProgress++;
                document.getElementById('story-progress').textContent = storyProgress;
                
                createParticles(e.target, 3);
                
                if (storyProgress === storyAnswers.length) {
                    createFireworks();
                    showPerfectScore();
                }
            } else if (selectedValue !== '') {
                e.target.classList.remove('bg-yellow-100', 'border-yellow-300');
                e.target.classList.add('bg-red-100', 'border-red-300');
                showFeedback('‚ùå', 'Not quite!', `Try again. Think about the tense needed here.`, false);
                
                setTimeout(() => {
                    e.target.classList.remove('bg-red-100', 'border-red-300');
                    e.target.classList.add('bg-yellow-100', 'border-yellow-300');
                    e.target.value = '';
                }, 1500);
            }
        }

        // Feedback system
        function showFeedback(icon, title, message, isSuccess) {
            document.getElementById('feedback-icon').textContent = icon;
            document.getElementById('feedback-title').textContent = title;
            document.getElementById('feedback-message').textContent = message;
            document.getElementById('feedback-modal').classList.remove('hidden');
        }

        function showPerfectScore() {
            document.getElementById('perfect-modal').classList.remove('hidden');
        }

        // Event listeners
        document.getElementById('feedback-close').addEventListener('click', () => {
            document.getElementById('feedback-modal').classList.add('hidden');
        });

        document.getElementById('perfect-close').addEventListener('click', () => {
            document.getElementById('perfect-modal').classList.add('hidden');
        });

        // Element SDK integration
        async function render(config) {
            document.getElementById('game-title').textContent = config.game_title || defaultConfig.game_title;
            document.getElementById('section-1-title').textContent = config.section_1_title || defaultConfig.section_1_title;
            document.getElementById('section-2-title').textContent = config.section_2_title || defaultConfig.section_2_title;
            document.getElementById('section-3-title').textContent = config.section_3_title || defaultConfig.section_3_title;
        }

        function mapToCapabilities(config) {
            return {
                recolorables: [],
                borderables: [],
                fontEditable: undefined,
                fontSizeable: undefined
            };
        }

        function mapToEditPanelValues(config) {
            return new Map([
                ['game_title', config.game_title || defaultConfig.game_title],
                ['section_1_title', config.section_1_title || defaultConfig.section_1_title],
                ['section_2_title', config.section_2_title || defaultConfig.section_2_title],
                ['section_3_title', config.section_3_title || defaultConfig.section_3_title]
            ]);
        }

        // Initialize Element SDK
        if (window.elementSdk) {
            window.elementSdk.init({
                defaultConfig,
                render,
                mapToCapabilities,
                mapToEditPanelValues
            });
        }

        // Start the game
        initializeGame();
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'991e435ff1ba3a30',t:'MTc2MTAyMzU4MC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>